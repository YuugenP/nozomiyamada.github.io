<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Beatles データベース</title>
  <link rel="shortcut icon" href="image/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="css/custom.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.js"></script>
  <style>
  iframe {
    width: 100% !important;
  }
  </style>
</head>

<body>
  <div class="container">
    <div class="page-header">
      <div class="row my-3">
        <div class="col-12">
          <h2>Beatles Database</h2>
          <a href="chorus.html">→ コーラス音源ページ</a>　<a href="https://drive.google.com/drive/folders/168FQpNl4pWatAuLdyxcJAVD6YWNXTDGi" target="_blank">→ Google Drive</a><br>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-lg-12">
        <div class="input-group">
          <div class="input-group-prepend">
            <button class="btn btn-danger" onclick="song_input.value='';song_input.focus();">clear</button>
          </div>
          <input type="input-group-text" class="form-control" list="songlist" id="song_input" placeholder="曲名で検索" oninput="make_list(this.value);" onchange="make_data(this.value);">
          <datalist id="songlist"></datalist>
        </div>
      </div>
      <div class="col-lg-12 mt-3">
        <div class="card">
          <div class="card-header">
            課題曲
          </div>
          <div class="card-body">
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Penny Lane')">Penny Lane</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Please Mister Postman')">Please Mister Postman</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Can\'t Buy Me Love')">Can't Buy Me Love</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('I Want To Hold Your Hand')">I Want To Hold Your Hand</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('All My Loving')">All My Loving</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Hey Bulldog')">Hey Bulldog</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Birthday')">Birthday</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Please Please Me')">Please Please Me</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Don\'t Let Me Down')">Don't Let Me Down</button>
            <button type="button" class="btn btn-success mb-1" onclick="make_data('Nowhere Man')">Nowhere Man</button>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            レパートリー
          </div>
          <div class="card-body">
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('A Hard Day\'s Night')">A Hard Day's Night</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Ticket To Ride')">Ticket To Ride</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('I Saw Her Standing There')">I Saw Her Standing There</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('In My Life')">In My Life</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Drive My Car')">Drive My Car</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Come Together')">Come Together</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Get Back');">Get Back</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Day Tripper')">Day Tripper</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('She Loves You')">She Loves You</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Back In The U.S.S.R.')">Back In The U.S.S.R.</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Help!')">Help!</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Baby\'s In Black')">Baby's In Black</button>
            <button type="button" class="btn btn-primary mb-1" onclick="make_data('Blackbird')">Blackbird</button>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            候補曲
          </div>
          <div class="card-body">
            
            <button type="button" class="btn btn-info mb-1" onclick="make_data('Let It Be')">Let It Be</button>
            <button type="button" class="btn btn-info mb-1" onclick="make_data('Anna (Go To Him)')">Anna (Go To Him)</button>
            
            
            <button type="button" class="btn btn-info mb-1" onclick="make_data('She\'s A Woman')">She's A Woman</button>
            <button type="button" class="btn btn-info mb-1" onclick="make_data('I Feel Fine')">I Feel Fine</button>
            
            <button type="button" class="btn btn-info mb-1" onclick="make_data('Eight Days A Week')">Eight Days A Week</button>
            <button type="button" class="btn btn-info mb-1" onclick="make_data('No Reply')">No Reply</button>
            <button type="button" class="btn btn-info mb-1" onclick="make_data('I\'ve Got A Feeling')">I've Got A Feeling</button>
            
            <button type="button" class="btn btn-info mb-1" onclick="make_data('She Said She Said')">She Said She Said</button>
            <button type="button" class="btn btn-info mb-1" onclick="make_data('Two Of Us')">Two Of Us</button>
          </div>
        </div>

      </div>
    </div>

    <div class="row mb-3">
      <div class="col-lg-12" id="vue_songdata">
        <h3>{{song}} ({{album}}, {{year}})</h3>
        ボーカル：{{vocal}}<br>
        コーラス：{{chorus}}<br>
        曲データ：<a v-bind:href="url" target="_blank">{{url}}</a><br>
        ボーカル動画：<a v-bind:href="yt_vocal" target="_blank">{{yt_vocal}}</a><br><br>
        <div id="spotify"></div><br>
        <div id="player"></div><br>
        <div v-html="lyrics"></div><br>
        <div id="bandscore"></div><br>
      </div>
    </div>
  </div>
  
  
  <script src="js/beatles.js"></script>
  <script>

    var vue = new Vue({
      el: "#vue_songdata",
      data: {
        song: 'song',
        album: 'album',
        year: 'year',
        vocal: '',
        chorus: '',
        url: 'https://beatlesdata.info/',
        yt_vocal: '',
        lyrics: ''
      }
    }) 

    function make_list(present_input){
      songlist.innerHTML = ""; // initialize
      present_input = present_input.replace(/[’]/g, "'");
      song_input.value = present_input;
      input_replaced = present_input.toLowerCase();
      // get present input
      if(input_replaced.length >= 1){
        var num_candidate = 0; 
        for(var song of SONGNAMES){
          song_replaced = song.toLowerCase();
          pattern1 = new RegExp("^" + input_replaced); // initial match
          if(song_replaced.match(pattern1)){
            songlist.innerHTML += `<option value="${song}">${song}</option>`;
            num_candidate += 1;
            if(num_candidate >= 10){break;} // show only 10 candidates
          }
        }
        for(var song of SONGNAMES){
          song_replaced = song.toLowerCase();
          pattern2 = new RegExp("^.+" + input_replaced); // non-initial match
          if(song_replaced.match(pattern2)){
            songlist.innerHTML += `<option value="${song}">${song}</option>`;
            num_candidate += 1;
            if(num_candidate >= 10){break;} // show only 10 candidates
          }
        }
      }
    }

    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          width: '100%',
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
      }

    function make_data(input){
      if(input in SONGDATA){
        song_input.value = input; // change the input form
        data = SONGDATA[input];
        vue.song = input;
        vue.album = data[0]
        vue.year = data[1];
        vue.vocal = data[2];
        vue.chorus = data[3];
        vue.url = data[4];
        vue.yt_vocal = (data[5]=='')? '' : 'https://youtu.be/' + data[5];
        player.cueVideoById({videoId: data[6]});
        spotify.innerHTML = `<audio controls id="audioplayer"><source src="music/${input}.mp3"></audio><iframe width="100%" src="https://open.spotify.com/embed/track/${data[7]}" allow="autoplay; clipboard-write; encrypted-media; fullscreen"></iframe>`
        vue.lyrics = data[8];
        bandscore.innerHTML = (PDFs.includes(input))? `<iframe src="music/scores/${input}.pdf" width="100%" height="1200"></iframe>` : '';       
        audioplayer.focus();
      } 
    }

  </script>
</body>
</html>